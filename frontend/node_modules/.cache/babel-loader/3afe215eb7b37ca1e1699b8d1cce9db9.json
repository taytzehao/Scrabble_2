{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\TzeHaoTay\\\\Desktop\\\\CS\\\\scrabble2\\\\frontend\\\\src\\\\Games_page\\\\Sachet.js\",\n    _s = $RefreshSig$();\n\nimport React, { useContext, useEffect, useRef } from 'react';\nimport './Sachet.css';\nimport { Invisible_tile_context, GamesContext, PlayerListContext, BlocksContext, TileDropContext } from './GamesContext.js';\nimport { useDrag, useDrop } from 'react-dnd';\nimport { games_sachet } from './Gamespage';\nimport { SocketContext } from '../UserContext.js';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst alphabet_data = [[\"A\", 9, 1], [\"B\", 2, 3], [\"C\", 2, 3], [\"D\", 4, 2], [\"E\", 12, 1], [\"F\", 2, 4], [\"G\", 3, 2], [\"H\", 2, 4], [\"I\", 9, 1], [\"J\", 1, 8], [\"K\", 1, 5], [\"L\", 4, 1], [\"M\", 2, 3], [\"N\", 6, 1], [\"O\", 8, 1], [\"P\", 2, 3], [\"Q\", 1, 10], [\"R\", 6, 1], [\"S\", 4, 1], [\"T\", 6, 1], [\"U\", 4, 1], [\"V\", 2, 4], [\"W\", 2, 4], [\"X\", 1, 8], [\"Y\", 2, 4], [\"Z\", 1, 10], [\" \", 2, 0]];\n\nfunction Tile(values) {\n  _s();\n\n  const {\n    tile_visibility,\n    set_tile_visibility\n  } = useContext(Invisible_tile_context);\n  const {\n    playerlistState,\n    setplayerlistState\n  } = useContext(PlayerListContext);\n  const {\n    gameState,\n    setgameState\n  } = useContext(GamesContext);\n  const {\n    boardState,\n    setboardState\n  } = useContext(BlocksContext);\n  const {\n    board_container_state,\n    container_container_state\n  } = useContext(TileDropContext);\n  const websocket = useContext(SocketContext);\n  const playerlistRef = useRef(null);\n  const gamestateRef = useRef(null);\n  const boardstateRef = useRef(null);\n  playerlistRef.current = playerlistState;\n  gamestateRef.current = gameState;\n  boardstateRef.current = boardState;\n  playerlistRef.current = playerlistState;\n  const ref = useRef(null);\n  const [{\n    isDragging\n  }, drag] = useDrag({\n    type: values.tile.active ? \"active\" : \"inactive\",\n    item: {\n      type: values.tile.active ? \"active\" : \"inactive\",\n      id: values.tile.id,\n      container_index: values.tile.container_index,\n      board_index: values.tile.board_index\n    },\n    canDrag: () => values.tile.canDrag,\n    collect: monitor => ({\n      isDragging: !!monitor.isDragging()\n    })\n  });\n  const [, drop] = useDrop({\n    accept: [\"active\", \"inactive\"],\n    canDrop: () => values.tile.canDrop,\n\n    drop(item, monitor) {\n      var _ref$current;\n\n      if (!ref.current) {\n        return;\n      }\n\n      let dragIndex;\n      let hoverIndex = values.tile.container_index;\n      let drop_container = playerlistRef.current[gamestateRef.current.your_index].tiles;\n      let drag_container;\n      let drag_block;\n      let update_just_added;\n      let drag_coordinate;\n      let hover_coordinate;\n      let drag_tile;\n      const hoverBoundingRect = (_ref$current = ref.current) === null || _ref$current === void 0 ? void 0 : _ref$current.getBoundingClientRect();\n      const clientOffset = monitor.getClientOffset();\n\n      if (values.orientation == \"horizontal\") {\n        drag_coordinate = clientOffset.x;\n        hover_coordinate = hoverBoundingRect.left + hoverBoundingRect.width / 2;\n      } else {\n        drag_coordinate = clientOffset.y;\n        hover_coordinate = hoverBoundingRect.top - hoverBoundingRect.height / 2;\n      }\n\n      if (item.container_index || item.container_index == 0) {\n        let hoverTile = playerlistRef.current[gamestateRef.current.your_index].tiles[hoverIndex];\n        drag_tile = playerlistRef.current[gamestateRef.current.your_index].tiles[item.container_index];\n        drop_container.splice(dragIndex, 1);\n        hoverIndex = drop_container.findIndex(tile => tile.id == hoverTile.id);\n        console.log(\"DRAG COORDINATE\");\n\n        if (drag_coordinate < hover_coordinate) {\n          console.log(\"BEFORE\");\n          drop_container.splice(hoverIndex, 0, drag_tile);\n        } else {\n          console.log(\"AFTER\");\n          drop_container.splice(hoverIndex + 1, 0, drag_tile);\n        }\n\n        for (let i = 0; i < drop_container.length; i++) {\n          drop_container[i].container_index = i;\n        }\n\n        container_container_state(gamestateRef.current.your_index, drop_container);\n      } else {\n        drag_tile = boardstateRef.current.blocks[item.board_index].content;\n\n        if (drag_tile.score == 0) {\n          drag_tile.alphabet = \" \";\n        }\n\n        ;\n        drag_tile.canDrop = true;\n        drag_tile.placed = false;\n        drag_tile.just_added = false;\n        drag_tile.board_index = undefined;\n        drag_block = boardstateRef.current[item.board_index];\n        drag_block.content = null;\n\n        if (drag_coordinate < hover_coordinate) {\n          drop_container.splice(hoverIndex, 0, drag_tile);\n        } else {\n          drop_container.splice(hoverIndex + 1, 0, drag_tile);\n        }\n\n        for (let i = hoverIndex; i < drop_container.length; i++) {\n          drop_container[i].container_index = i;\n        }\n\n        update_just_added = gamestateRef.current.just_added.filter(index => index != item.board_index);\n        board_container_state(gamestateRef.current.your_index, drag_block, drop_container, update_just_added);\n      }\n\n      websocket.current.emit(\"emit_drop_container\", {\n        room_id: gamestateRef.current.room_id,\n        player_index: gamestateRef.current.your_index,\n        drag_block: item.board_index == 0 || item.board_index ? drag_block : item.board_index,\n        drop_container: drop_container,\n        just_added: item.board_index == 0 || item.board_index ? update_just_added : item.board_index\n      });\n    }\n\n  });\n  let tile_name = \"game_tile\";\n\n  if (values.tile.placed) {\n    tile_name = tile_name + \" placed\";\n  }\n\n  const content_style = {\n    visibility: tile_visibility\n  };\n  const dragstyle = {\n    opacity: isDragging ? 0.5 : 1\n  };\n  drop(drag(ref));\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: tile_name,\n    ref: ref,\n    style: dragstyle,\n    children: [/*#__PURE__*/_jsxDEV(\"p\", {\n      style: content_style,\n      children: values.tile.alphabet\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      style: content_style,\n      children: values.tile.score\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 135,\n    columnNumber: 9\n  }, this);\n}\n\n_s(Tile, \"kgj08yOsfG+m8aAkkjIfmuBtgag=\", false, function () {\n  return [useDrag, useDrop];\n});\n\n_c = Tile;\n\nclass Sachet {\n  constructor() {\n    this.tiles = [];\n    this.initialize();\n  }\n\n  initialize() {\n    let tile_id = 0;\n\n    for (let i = 0; i < alphabet_data.length; i++) {\n      for (let j = 0; j < alphabet_data[i][1]; j++) {\n        this.tiles.push({\n          alphabet: alphabet_data[i][0],\n          score: alphabet_data[i][2],\n          id: tile_id,\n          placed: false,\n          just_added: false,\n          challenge: false,\n          active: true,\n          canDrag: false,\n          canDrop: false,\n          container_index: undefined,\n          board_index: undefined\n        });\n        tile_id += 1;\n      }\n    }\n  }\n\n  remove_by_tiles(tiles) {\n    this.tiles = this.tiles.filter(function (e) {\n      return this.findIndex(tile => tile.id == e.id) < 0;\n    }, tiles);\n  }\n\n  add_by_tiles(tiles) {\n    this.tiles = this.tiles.concat(tiles);\n  }\n\n}\n\nconst analytics_data = [];\n\nfor (let i = 0; i < alphabet_data.length; i++) {\n  analytics_data.push({\n    alphabet: alphabet_data[i][0],\n    num: alphabet_data[i][1]\n  });\n}\n\nexport { analytics_data, Tile };\nexport default Sachet;\n\nvar _c;\n\n$RefreshReg$(_c, \"Tile\");","map":{"version":3,"sources":["C:/Users/TzeHaoTay/Desktop/CS/scrabble2/frontend/src/Games_page/Sachet.js"],"names":["React","useContext","useEffect","useRef","Invisible_tile_context","GamesContext","PlayerListContext","BlocksContext","TileDropContext","useDrag","useDrop","games_sachet","SocketContext","alphabet_data","Tile","values","tile_visibility","set_tile_visibility","playerlistState","setplayerlistState","gameState","setgameState","boardState","setboardState","board_container_state","container_container_state","websocket","playerlistRef","gamestateRef","boardstateRef","current","ref","isDragging","drag","type","tile","active","item","id","container_index","board_index","canDrag","collect","monitor","drop","accept","canDrop","dragIndex","hoverIndex","drop_container","your_index","tiles","drag_container","drag_block","update_just_added","drag_coordinate","hover_coordinate","drag_tile","hoverBoundingRect","getBoundingClientRect","clientOffset","getClientOffset","orientation","x","left","width","y","top","height","hoverTile","splice","findIndex","console","log","i","length","blocks","content","score","alphabet","placed","just_added","undefined","filter","index","emit","room_id","player_index","tile_name","content_style","visibility","dragstyle","opacity","Sachet","constructor","initialize","tile_id","j","push","challenge","remove_by_tiles","e","add_by_tiles","concat","analytics_data","num"],"mappings":";;;AAAA,OAAOA,KAAP,IAAcC,UAAd,EAAyBC,SAAzB,EAAmCC,MAAnC,QAAgD,OAAhD;AACA,OAAO,cAAP;AACA,SAAQC,sBAAR,EAA+BC,YAA/B,EAA4CC,iBAA5C,EAA8DC,aAA9D,EAA4EC,eAA5E,QAAkG,mBAAlG;AACA,SAAQC,OAAR,EAAgBC,OAAhB,QAA8B,WAA9B;AACA,SAASC,YAAT,QAA6B,aAA7B;AACA,SAAQC,aAAR,QAA4B,mBAA5B;;AAIA,MAAMC,aAAa,GAAG,CAAC,CAAC,GAAD,EAAK,CAAL,EAAO,CAAP,CAAD,EAAW,CAAC,GAAD,EAAK,CAAL,EAAO,CAAP,CAAX,EAAqB,CAAC,GAAD,EAAK,CAAL,EAAO,CAAP,CAArB,EAA+B,CAAC,GAAD,EAAK,CAAL,EAAO,CAAP,CAA/B,EAAyC,CAAC,GAAD,EAAK,EAAL,EAAQ,CAAR,CAAzC,EAAoD,CAAC,GAAD,EAAK,CAAL,EAAO,CAAP,CAApD,EAA8D,CAAC,GAAD,EAAK,CAAL,EAAO,CAAP,CAA9D,EACE,CAAC,GAAD,EAAK,CAAL,EAAO,CAAP,CADF,EACY,CAAC,GAAD,EAAK,CAAL,EAAO,CAAP,CADZ,EACsB,CAAC,GAAD,EAAK,CAAL,EAAO,CAAP,CADtB,EACgC,CAAC,GAAD,EAAK,CAAL,EAAO,CAAP,CADhC,EAC0C,CAAC,GAAD,EAAK,CAAL,EAAO,CAAP,CAD1C,EACoD,CAAC,GAAD,EAAK,CAAL,EAAO,CAAP,CADpD,EAC8D,CAAC,GAAD,EAAK,CAAL,EAAO,CAAP,CAD9D,EAEE,CAAC,GAAD,EAAK,CAAL,EAAO,CAAP,CAFF,EAEY,CAAC,GAAD,EAAK,CAAL,EAAO,CAAP,CAFZ,EAEsB,CAAC,GAAD,EAAK,CAAL,EAAO,EAAP,CAFtB,EAEiC,CAAC,GAAD,EAAK,CAAL,EAAO,CAAP,CAFjC,EAE2C,CAAC,GAAD,EAAK,CAAL,EAAO,CAAP,CAF3C,EAEqD,CAAC,GAAD,EAAK,CAAL,EAAO,CAAP,CAFrD,EAE+D,CAAC,GAAD,EAAK,CAAL,EAAO,CAAP,CAF/D,EAGE,CAAC,GAAD,EAAK,CAAL,EAAO,CAAP,CAHF,EAGY,CAAC,GAAD,EAAK,CAAL,EAAO,CAAP,CAHZ,EAGsB,CAAC,GAAD,EAAK,CAAL,EAAO,CAAP,CAHtB,EAGgC,CAAC,GAAD,EAAK,CAAL,EAAO,CAAP,CAHhC,EAG0C,CAAC,GAAD,EAAK,CAAL,EAAO,EAAP,CAH1C,EAGqD,CAAC,GAAD,EAAK,CAAL,EAAO,CAAP,CAHrD,CAAtB;;AAKA,SAASC,IAAT,CAAeC,MAAf,EAAsB;AAAA;;AAClB,QAAM;AAACC,IAAAA,eAAD;AAAiBC,IAAAA;AAAjB,MAAsChB,UAAU,CAACG,sBAAD,CAAtD;AACA,QAAM;AAACc,IAAAA,eAAD;AAAiBC,IAAAA;AAAjB,MAAqClB,UAAU,CAACK,iBAAD,CAArD;AACA,QAAM;AAACc,IAAAA,SAAD;AAAWC,IAAAA;AAAX,MAAyBpB,UAAU,CAACI,YAAD,CAAzC;AACA,QAAM;AAACiB,IAAAA,UAAD;AAAYC,IAAAA;AAAZ,MAA2BtB,UAAU,CAACM,aAAD,CAA3C;AACA,QAAM;AAACiB,IAAAA,qBAAD;AAAuBC,IAAAA;AAAvB,MAAkDxB,UAAU,CAACO,eAAD,CAAlE;AACA,QAAMkB,SAAS,GAACzB,UAAU,CAACW,aAAD,CAA1B;AACA,QAAMe,aAAa,GAACxB,MAAM,CAAC,IAAD,CAA1B;AACA,QAAMyB,YAAY,GAACzB,MAAM,CAAC,IAAD,CAAzB;AACA,QAAM0B,aAAa,GAAC1B,MAAM,CAAC,IAAD,CAA1B;AACAwB,EAAAA,aAAa,CAACG,OAAd,GAAsBZ,eAAtB;AACAU,EAAAA,YAAY,CAACE,OAAb,GAAqBV,SAArB;AACAS,EAAAA,aAAa,CAACC,OAAd,GAAsBR,UAAtB;AAEAK,EAAAA,aAAa,CAACG,OAAd,GAAsBZ,eAAtB;AAGA,QAAMa,GAAG,GAAG5B,MAAM,CAAC,IAAD,CAAlB;AAEA,QAAM,CAAC;AAAC6B,IAAAA;AAAD,GAAD,EAAcC,IAAd,IAAoBxB,OAAO,CAAC;AAC9ByB,IAAAA,IAAI,EAAGnB,MAAM,CAACoB,IAAP,CAAYC,MAAb,GAAuB,QAAvB,GAAgC,UADR;AAE9BC,IAAAA,IAAI,EAAC;AACDH,MAAAA,IAAI,EAAEnB,MAAM,CAACoB,IAAP,CAAYC,MAAb,GAAuB,QAAvB,GAAgC,UADpC;AAEDE,MAAAA,EAAE,EAACvB,MAAM,CAACoB,IAAP,CAAYG,EAFd;AAGDC,MAAAA,eAAe,EAAExB,MAAM,CAACoB,IAAP,CAAYI,eAH5B;AAIDC,MAAAA,WAAW,EAAEzB,MAAM,CAACoB,IAAP,CAAYK;AAJxB,KAFyB;AAQ9BC,IAAAA,OAAO,EAAC,MAAI1B,MAAM,CAACoB,IAAP,CAAYM,OARM;AAS9BC,IAAAA,OAAO,EAAEC,OAAO,KAAK;AACjBX,MAAAA,UAAU,EAAE,CAAC,CAAEW,OAAO,CAACX,UAAR;AADE,KAAL;AATc,GAAD,CAAjC;AAcA,QAAM,GAAEY,IAAF,IAAQlC,OAAO,CAAC;AAClBmC,IAAAA,MAAM,EAAE,CAAC,QAAD,EAAU,UAAV,CADU;AAElBC,IAAAA,OAAO,EAAC,MAAI/B,MAAM,CAACoB,IAAP,CAAYW,OAFN;;AAGlBF,IAAAA,IAAI,CAACP,IAAD,EAAOM,OAAP,EAAgB;AAAA;;AAChB,UAAI,CAACZ,GAAG,CAACD,OAAT,EAAkB;AACd;AACH;;AACD,UAAIiB,SAAJ;AACA,UAAIC,UAAU,GAAGjC,MAAM,CAACoB,IAAP,CAAYI,eAA7B;AAEA,UAAIU,cAAc,GAACtB,aAAa,CAACG,OAAd,CAAsBF,YAAY,CAACE,OAAb,CAAqBoB,UAA3C,EAAuDC,KAA1E;AACA,UAAIC,cAAJ;AACA,UAAIC,UAAJ;AACA,UAAIC,iBAAJ;AAEA,UAAIC,eAAJ;AACA,UAAIC,gBAAJ;AACA,UAAIC,SAAJ;AAEA,YAAMC,iBAAiB,mBAAG3B,GAAG,CAACD,OAAP,iDAAG,aAAa6B,qBAAb,EAA1B;AACA,YAAMC,YAAY,GAAGjB,OAAO,CAACkB,eAAR,EAArB;;AAEA,UAAG9C,MAAM,CAAC+C,WAAP,IAAoB,YAAvB,EAAoC;AAChCP,QAAAA,eAAe,GAACK,YAAY,CAACG,CAA7B;AACAP,QAAAA,gBAAgB,GAACE,iBAAiB,CAACM,IAAlB,GAAuBN,iBAAiB,CAACO,KAAlB,GAAwB,CAAhE;AACH,OAHD,MAGK;AACDV,QAAAA,eAAe,GAACK,YAAY,CAACM,CAA7B;AACAV,QAAAA,gBAAgB,GAACE,iBAAiB,CAACS,GAAlB,GAAsBT,iBAAiB,CAACU,MAAlB,GAAyB,CAAhE;AACH;;AACD,UAAG/B,IAAI,CAACE,eAAL,IAAwBF,IAAI,CAACE,eAAL,IAAsB,CAAjD,EAAmD;AAC/C,YAAI8B,SAAS,GAAC1C,aAAa,CAACG,OAAd,CAAsBF,YAAY,CAACE,OAAb,CAAqBoB,UAA3C,EAAuDC,KAAvD,CAA6DH,UAA7D,CAAd;AACAS,QAAAA,SAAS,GAAC9B,aAAa,CAACG,OAAd,CAAsBF,YAAY,CAACE,OAAb,CAAqBoB,UAA3C,EAAuDC,KAAvD,CAA6Dd,IAAI,CAACE,eAAlE,CAAV;AAEAU,QAAAA,cAAc,CAACqB,MAAf,CAAsBvB,SAAtB,EAAgC,CAAhC;AACAC,QAAAA,UAAU,GAACC,cAAc,CAACsB,SAAf,CAAyBpC,IAAI,IAAEA,IAAI,CAACG,EAAL,IAAS+B,SAAS,CAAC/B,EAAlD,CAAX;AACAkC,QAAAA,OAAO,CAACC,GAAR,CAAY,iBAAZ;;AACA,YAAGlB,eAAe,GAACC,gBAAnB,EAAoC;AAChCgB,UAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ;AACAxB,UAAAA,cAAc,CAACqB,MAAf,CAAsBtB,UAAtB,EAAiC,CAAjC,EAAmCS,SAAnC;AACH,SAHD,MAGK;AACDe,UAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ;AACAxB,UAAAA,cAAc,CAACqB,MAAf,CAAsBtB,UAAU,GAAC,CAAjC,EAAmC,CAAnC,EAAqCS,SAArC;AACH;;AAED,aAAK,IAAIiB,CAAC,GAAC,CAAX,EAAaA,CAAC,GAACzB,cAAc,CAAC0B,MAA9B,EAAqCD,CAAC,EAAtC,EAAyC;AAACzB,UAAAA,cAAc,CAACyB,CAAD,CAAd,CAAkBnC,eAAlB,GAAkCmC,CAAlC;AAAoC;;AAC9EjD,QAAAA,yBAAyB,CAACG,YAAY,CAACE,OAAb,CAAqBoB,UAAtB,EAAiCD,cAAjC,CAAzB;AAEH,OAlBD,MAkBK;AACDQ,QAAAA,SAAS,GAAC5B,aAAa,CAACC,OAAd,CAAsB8C,MAAtB,CAA6BvC,IAAI,CAACG,WAAlC,EAA+CqC,OAAzD;;AAIA,YAAGpB,SAAS,CAACqB,KAAV,IAAiB,CAApB,EAAsB;AAACrB,UAAAA,SAAS,CAACsB,QAAV,GAAmB,GAAnB;AAAuB;;AAAA;AAC9CtB,QAAAA,SAAS,CAACX,OAAV,GAAkB,IAAlB;AACAW,QAAAA,SAAS,CAACuB,MAAV,GAAiB,KAAjB;AACAvB,QAAAA,SAAS,CAACwB,UAAV,GAAqB,KAArB;AACAxB,QAAAA,SAAS,CAACjB,WAAV,GAAsB0C,SAAtB;AAEA7B,QAAAA,UAAU,GAACxB,aAAa,CAACC,OAAd,CAAsBO,IAAI,CAACG,WAA3B,CAAX;AACAa,QAAAA,UAAU,CAACwB,OAAX,GAAmB,IAAnB;;AAEA,YAAGtB,eAAe,GAACC,gBAAnB,EAAoC;AAChCP,UAAAA,cAAc,CAACqB,MAAf,CAAsBtB,UAAtB,EAAiC,CAAjC,EAAmCS,SAAnC;AACH,SAFD,MAEK;AACDR,UAAAA,cAAc,CAACqB,MAAf,CAAsBtB,UAAU,GAAC,CAAjC,EAAmC,CAAnC,EAAqCS,SAArC;AACH;;AACD,aAAK,IAAIiB,CAAC,GAAC1B,UAAX,EAAsB0B,CAAC,GAACzB,cAAc,CAAC0B,MAAvC,EAA8CD,CAAC,EAA/C,EAAkD;AAACzB,UAAAA,cAAc,CAACyB,CAAD,CAAd,CAAkBnC,eAAlB,GAAkCmC,CAAlC;AAAoC;;AACvFpB,QAAAA,iBAAiB,GAAC1B,YAAY,CAACE,OAAb,CAAqBmD,UAArB,CAAgCE,MAAhC,CAAuCC,KAAK,IAAEA,KAAK,IAAE/C,IAAI,CAACG,WAA1D,CAAlB;AACAhB,QAAAA,qBAAqB,CAACI,YAAY,CAACE,OAAb,CAAqBoB,UAAtB,EAAiCG,UAAjC,EAA4CJ,cAA5C,EAA2DK,iBAA3D,CAArB;AAEH;;AACD5B,MAAAA,SAAS,CAACI,OAAV,CAAkBuD,IAAlB,CAAuB,qBAAvB,EAA6C;AACzCC,QAAAA,OAAO,EAAC1D,YAAY,CAACE,OAAb,CAAqBwD,OADY;AAEzCC,QAAAA,YAAY,EAAC3D,YAAY,CAACE,OAAb,CAAqBoB,UAFO;AAGzCG,QAAAA,UAAU,EAAEhB,IAAI,CAACG,WAAL,IAAkB,CAAlB,IAAuBH,IAAI,CAACG,WAA7B,GAA4Ca,UAA5C,GAAyDhB,IAAI,CAACG,WAHhC;AAIzCS,QAAAA,cAAc,EAACA,cAJ0B;AAKzCgC,QAAAA,UAAU,EAAE5C,IAAI,CAACG,WAAL,IAAkB,CAAlB,IAAuBH,IAAI,CAACG,WAA7B,GAA4Cc,iBAA5C,GAA+DjB,IAAI,CAACG;AALtC,OAA7C;AAOH;;AA9EiB,GAAD,CAArB;AAiFA,MAAIgD,SAAS,GAAC,WAAd;;AACA,MAAGzE,MAAM,CAACoB,IAAP,CAAY6C,MAAf,EAAsB;AAACQ,IAAAA,SAAS,GAAGA,SAAS,GAAG,SAAxB;AAAkC;;AACzD,QAAMC,aAAa,GAAC;AAACC,IAAAA,UAAU,EAAC1E;AAAZ,GAApB;AACA,QAAM2E,SAAS,GAAC;AAACC,IAAAA,OAAO,EAAE5D,UAAD,GAAe,GAAf,GAAqB;AAA9B,GAAhB;AACAY,EAAAA,IAAI,CAACX,IAAI,CAACF,GAAD,CAAL,CAAJ;AACA,sBACI;AAAK,IAAA,SAAS,EAAEyD,SAAhB;AAA2B,IAAA,GAAG,EAAEzD,GAAhC;AAAqC,IAAA,KAAK,EAAE4D,SAA5C;AAAA,4BACA;AAAG,MAAA,KAAK,EAAEF,aAAV;AAAA,gBAA0B1E,MAAM,CAACoB,IAAP,CAAY4C;AAAtC;AAAA;AAAA;AAAA;AAAA,YADA,eAEA;AAAG,MAAA,KAAK,EAAEU,aAAV;AAAA,gBAA0B1E,MAAM,CAACoB,IAAP,CAAY2C;AAAtC;AAAA;AAAA;AAAA;AAAA,YAFA;AAAA;AAAA;AAAA;AAAA;AAAA,UADJ;AAMH;;GA7HQhE,I;UAmBqBL,O,EAcZC,O;;;KAjCTI,I;;AA+HT,MAAM+E,MAAN,CAAY;AACRC,EAAAA,WAAW,GAAE;AACT,SAAK3C,KAAL,GAAW,EAAX;AACA,SAAK4C,UAAL;AACH;;AACDA,EAAAA,UAAU,GAAE;AACR,QAAIC,OAAO,GAAC,CAAZ;;AACA,SAAK,IAAItB,CAAC,GAAC,CAAX,EAAaA,CAAC,GAAC7D,aAAa,CAAC8D,MAA7B,EAAoCD,CAAC,EAArC,EAAwC;AACpC,WAAK,IAAIuB,CAAC,GAAC,CAAX,EAAaA,CAAC,GAACpF,aAAa,CAAC6D,CAAD,CAAb,CAAiB,CAAjB,CAAf,EAAmCuB,CAAC,EAApC,EAAuC;AACnC,aAAK9C,KAAL,CAAW+C,IAAX,CAAgB;AACZnB,UAAAA,QAAQ,EAAClE,aAAa,CAAC6D,CAAD,CAAb,CAAiB,CAAjB,CADG;AAEZI,UAAAA,KAAK,EAACjE,aAAa,CAAC6D,CAAD,CAAb,CAAiB,CAAjB,CAFM;AAGZpC,UAAAA,EAAE,EAAC0D,OAHS;AAIZhB,UAAAA,MAAM,EAAC,KAJK;AAKZC,UAAAA,UAAU,EAAC,KALC;AAMZkB,UAAAA,SAAS,EAAC,KANE;AAOZ/D,UAAAA,MAAM,EAAC,IAPK;AAQZK,UAAAA,OAAO,EAAC,KARI;AASZK,UAAAA,OAAO,EAAC,KATI;AAUZP,UAAAA,eAAe,EAAC2C,SAVJ;AAWZ1C,UAAAA,WAAW,EAAC0C;AAXA,SAAhB;AAaAc,QAAAA,OAAO,IAAE,CAAT;AACH;AACJ;AACJ;;AACDI,EAAAA,eAAe,CAACjD,KAAD,EAAO;AAClB,SAAKA,KAAL,GAAW,KAAKA,KAAL,CAAWgC,MAAX,CAAkB,UAASkB,CAAT,EAAY;AAAC,aAAO,KAAK9B,SAAL,CAAepC,IAAI,IAAEA,IAAI,CAACG,EAAL,IAAS+D,CAAC,CAAC/D,EAAhC,IAAsC,CAA7C;AAAgD,KAA/E,EAAgFa,KAAhF,CAAX;AACH;;AACDmD,EAAAA,YAAY,CAACnD,KAAD,EAAO;AACf,SAAKA,KAAL,GAAW,KAAKA,KAAL,CAAWoD,MAAX,CAAkBpD,KAAlB,CAAX;AACH;;AA/BO;;AAiCZ,MAAMqD,cAAc,GAAG,EAAvB;;AACA,KAAK,IAAI9B,CAAC,GAAC,CAAX,EAAaA,CAAC,GAAC7D,aAAa,CAAC8D,MAA7B,EAAoCD,CAAC,EAArC,EAAwC;AACpC8B,EAAAA,cAAc,CAACN,IAAf,CAAoB;AAACnB,IAAAA,QAAQ,EAAClE,aAAa,CAAC6D,CAAD,CAAb,CAAiB,CAAjB,CAAV;AAA8B+B,IAAAA,GAAG,EAAC5F,aAAa,CAAC6D,CAAD,CAAb,CAAiB,CAAjB;AAAlC,GAApB;AACH;;AACD,SAAQ8B,cAAR,EAAuB1F,IAAvB;AAEA,eAAe+E,MAAf","sourcesContent":["import React,{useContext,useEffect,useRef} from 'react';\r\nimport './Sachet.css';\r\nimport {Invisible_tile_context,GamesContext,PlayerListContext,BlocksContext,TileDropContext} from './GamesContext.js';\r\nimport {useDrag,useDrop} from 'react-dnd'\r\nimport { games_sachet } from './Gamespage';\r\nimport {SocketContext} from '../UserContext.js';\r\n\r\n\r\n\r\nconst alphabet_data = [[\"A\",9,1],[\"B\",2,3],[\"C\",2,3],[\"D\",4,2],[\"E\",12,1],[\"F\",2,4],[\"G\",3,2],\r\n                        [\"H\",2,4],[\"I\",9,1],[\"J\",1,8],[\"K\",1,5],[\"L\",4,1],[\"M\",2,3],[\"N\",6,1],\r\n                        [\"O\",8,1],[\"P\",2,3],[\"Q\",1,10],[\"R\",6,1],[\"S\",4,1],[\"T\",6,1],[\"U\",4,1],\r\n                        [\"V\",2,4],[\"W\",2,4],[\"X\",1,8],[\"Y\",2,4],[\"Z\",1,10],[\" \",2,0]]\r\n\r\nfunction Tile (values){\r\n    const {tile_visibility,set_tile_visibility}=useContext(Invisible_tile_context)\r\n    const {playerlistState,setplayerlistState}=useContext(PlayerListContext)\r\n    const {gameState,setgameState}=useContext(GamesContext)   \r\n    const {boardState,setboardState}=useContext(BlocksContext)\r\n    const {board_container_state,container_container_state}=useContext(TileDropContext)\r\n    const websocket=useContext(SocketContext)\r\n    const playerlistRef=useRef(null);\r\n    const gamestateRef=useRef(null);\r\n    const boardstateRef=useRef(null);\r\n    playerlistRef.current=playerlistState\r\n    gamestateRef.current=gameState\r\n    boardstateRef.current=boardState\r\n\r\n    playerlistRef.current=playerlistState\r\n\r\n\r\n    const ref = useRef(null)\r\n   \r\n    const [{isDragging},drag]=useDrag({\r\n        type: (values.tile.active) ? \"active\":\"inactive\",\r\n        item:{\r\n            type:(values.tile.active) ? \"active\":\"inactive\",\r\n            id:values.tile.id,\r\n            container_index: values.tile.container_index,\r\n            board_index: values.tile.board_index\r\n        },\r\n        canDrag:()=>values.tile.canDrag,\r\n        collect: monitor => ({\r\n            isDragging: !! monitor.isDragging()\r\n        })\r\n    })\r\n    \r\n    const [,drop]=useDrop({\r\n        accept: [\"active\",\"inactive\"],\r\n        canDrop:()=>values.tile.canDrop,\r\n        drop(item, monitor) {\r\n            if (!ref.current) {\r\n                return;\r\n            }\r\n            let dragIndex;\r\n            let hoverIndex = values.tile.container_index;\r\n\r\n            let drop_container=playerlistRef.current[gamestateRef.current.your_index].tiles;\r\n            let drag_container;\r\n            let drag_block;\r\n            let update_just_added;\r\n\r\n            let drag_coordinate;\r\n            let hover_coordinate;\r\n            let drag_tile;\r\n\r\n            const hoverBoundingRect = ref.current?.getBoundingClientRect();            \r\n            const clientOffset = monitor.getClientOffset();\r\n\r\n            if(values.orientation==\"horizontal\"){\r\n                drag_coordinate=clientOffset.x;\r\n                hover_coordinate=hoverBoundingRect.left+hoverBoundingRect.width/2\r\n            }else{\r\n                drag_coordinate=clientOffset.y;\r\n                hover_coordinate=hoverBoundingRect.top-hoverBoundingRect.height/2\r\n            }\r\n            if(item.container_index || item.container_index==0){\r\n                let hoverTile=playerlistRef.current[gamestateRef.current.your_index].tiles[hoverIndex]\r\n                drag_tile=playerlistRef.current[gamestateRef.current.your_index].tiles[item.container_index]\r\n                \r\n                drop_container.splice(dragIndex,1)\r\n                hoverIndex=drop_container.findIndex(tile=>tile.id==hoverTile.id)\r\n                console.log(\"DRAG COORDINATE\")\r\n                if(drag_coordinate<hover_coordinate){\r\n                    console.log(\"BEFORE\")\r\n                    drop_container.splice(hoverIndex,0,drag_tile)\r\n                }else{\r\n                    console.log(\"AFTER\")\r\n                    drop_container.splice(hoverIndex+1,0,drag_tile)\r\n                }\r\n\r\n                for (let i=0;i<drop_container.length;i++){drop_container[i].container_index=i}\r\n                container_container_state(gamestateRef.current.your_index,drop_container)\r\n                \r\n            }else{\r\n                drag_tile=boardstateRef.current.blocks[item.board_index].content\r\n\r\n                \r\n\r\n                if(drag_tile.score==0){drag_tile.alphabet=\" \"};\r\n                drag_tile.canDrop=true;\r\n                drag_tile.placed=false\r\n                drag_tile.just_added=false;\r\n                drag_tile.board_index=undefined;\r\n\r\n                drag_block=boardstateRef.current[item.board_index]\r\n                drag_block.content=null\r\n\r\n                if(drag_coordinate<hover_coordinate){\r\n                    drop_container.splice(hoverIndex,0,drag_tile)\r\n                }else{\r\n                    drop_container.splice(hoverIndex+1,0,drag_tile)\r\n                }\r\n                for (let i=hoverIndex;i<drop_container.length;i++){drop_container[i].container_index=i}\r\n                update_just_added=gamestateRef.current.just_added.filter(index=>index!=item.board_index)\r\n                board_container_state(gamestateRef.current.your_index,drag_block,drop_container,update_just_added)\r\n                \r\n            }\r\n            websocket.current.emit(\"emit_drop_container\",{\r\n                room_id:gamestateRef.current.room_id,\r\n                player_index:gamestateRef.current.your_index,\r\n                drag_block:(item.board_index==0 || item.board_index) ? drag_block : item.board_index,\r\n                drop_container:drop_container,\r\n                just_added:(item.board_index==0 || item.board_index) ? update_just_added: item.board_index\r\n            })\r\n        },\r\n    })\r\n    \r\n    let tile_name=\"game_tile\"\r\n    if(values.tile.placed){tile_name = tile_name + \" placed\"}\r\n    const content_style={visibility:tile_visibility}\r\n    const dragstyle={opacity:(isDragging) ? 0.5 : 1}\r\n    drop(drag(ref))\r\n    return(\r\n        <div className={tile_name} ref={ref} style={dragstyle}>\r\n        <p style={content_style}>{values.tile.alphabet}</p>\r\n        <p style={content_style}>{values.tile.score}</p>\r\n        </div>\r\n    )\r\n}\r\n\r\nclass Sachet{\r\n    constructor(){\r\n        this.tiles=[]\r\n        this.initialize()\r\n    }\r\n    initialize(){\r\n        let tile_id=0\r\n        for (let i=0;i<alphabet_data.length;i++){\r\n            for (let j=0;j<alphabet_data[i][1];j++){\r\n                this.tiles.push({\r\n                    alphabet:alphabet_data[i][0],\r\n                    score:alphabet_data[i][2],\r\n                    id:tile_id,\r\n                    placed:false,\r\n                    just_added:false,\r\n                    challenge:false,\r\n                    active:true,\r\n                    canDrag:false,\r\n                    canDrop:false,\r\n                    container_index:undefined,\r\n                    board_index:undefined\r\n                }) \r\n                tile_id+=1 \r\n            } \r\n        }\r\n    }\r\n    remove_by_tiles(tiles){    \r\n        this.tiles=this.tiles.filter(function(e) {return this.findIndex(tile=>tile.id==e.id) < 0;},tiles)\r\n    }\r\n    add_by_tiles(tiles){\r\n        this.tiles=this.tiles.concat(tiles)\r\n    }\r\n} \r\nconst analytics_data = []\r\nfor (let i=0;i<alphabet_data.length;i++){\r\n    analytics_data.push({alphabet:alphabet_data[i][0],num:alphabet_data[i][1]})\r\n}\r\nexport {analytics_data,Tile}\r\n\r\nexport default Sachet;\r\n\r\n"]},"metadata":{},"sourceType":"module"}