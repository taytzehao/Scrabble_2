{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\TzeHaoTay\\\\Desktop\\\\CS\\\\scrabble2\\\\frontend\\\\src\\\\Games_page\\\\Action\\\\Draw_button.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useContext, useEffect, useRef } from 'react';\nimport { UserContext } from '../../UserContext.js';\nimport { GamesContext, BlocksContext, PlayerListContext } from '../GamesContext.js';\nimport { games_sachet } from '../Gamespage.js';\nimport './Actionbar.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction Draw_button(values) {\n  _s();\n\n  const {\n    profile,\n    setprofile\n  } = useContext(UserContext);\n  const {\n    playerlistState,\n    setplayerlistState\n  } = useContext(PlayerListContext);\n  const {\n    gameState,\n    setgameState\n  } = useContext(GamesContext);\n  const playerlistRef = useRef(null);\n  const gamestateRef = useRef(null);\n  playerlistRef.current = playerlistState;\n  gamestateRef.current = gameState;\n  const [drawActive, setdrawActive] = useState(false);\n\n  function Draw() {\n    var drawn_tiles = playerlistRef.current[gamestateRef.current.player_turn].draw();\n    let return_tiles = playerlistRef.current[gamestateRef.current.player_turn].delete_list;\n\n    for (let i = 0; i < return_tiles.length; i++) {\n      return_tiles[i].canDrop = false;\n      return_tiles[i].canDrag = false;\n      return_tiles[i].container_index = null;\n      return_tiles[i].board_index = null;\n      return_tiles[i].placed = false;\n      return_tiles[i].just_added = false;\n    }\n\n    return_tiles.forEach(return_tile => {\n      games_sachet.push(return_tile);\n    });\n    setplayerlistState(prevplayerlist => {\n      let newplayerlist = [...prevplayerlist];\n      newplayerlist[gamestateRef.current.player_turn].tiles = newplayerlist[gamestateRef.current.player_turn].tiles.concat(drawn_tiles);\n      newplayerlist[gamestateRef.current.player_turn].delete_list = [];\n      return newplayerlist;\n    });\n    values.next_func();\n    gamestateRef.current.socket.emit(\"emit_draw\", {\n      player_turn: gamestateRef.current.player_turn,\n      drawn_tiles: drawn_tiles,\n      removed_tiles: playerlistRef.current[gamestateRef.current.player_turn].delete_list\n    });\n  }\n\n  useEffect(() => {\n    gamestateRef.current.socket.current.on(\"update_player_draw\", socket_out => {\n      games_sachet = games_sachet.concat(socket_out.removed_tiles);\n      setplayerlistState(prevplayerlist => {\n        let newplayerlist = [...prevplayerlist];\n        newplayerlist[gamestateRef.player_turn].draw_by_tiles(socket_out.drawn_tiles);\n        newplayerlist[gamestateRef.player_turn].delete_list = [];\n        return newplayerlist;\n      });\n      values.next_func();\n    });\n  }, []);\n  useEffect(() => {\n    if (gamestateRef.current.player_turn == gamestateRef.current.your_index && !gamestateRef.current.just_added.length) {\n      setdrawActive(true);\n    } else {\n      setdrawActive(false);\n    }\n  }, [, gamestateRef.current.player_turn, gamestateRef.current.just_added]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"button\",\n      className: \"draw_button\",\n      onClick: Draw,\n      disabled: !drawActive,\n      children: \"Draw\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 66,\n    columnNumber: 9\n  }, this);\n}\n\n_s(Draw_button, \"QCPQbWpUFXTsWGS6E5rQ5A4zqLc=\");\n\n_c = Draw_button;\nexport default Draw_button;\n\nvar _c;\n\n$RefreshReg$(_c, \"Draw_button\");","map":{"version":3,"sources":["C:/Users/TzeHaoTay/Desktop/CS/scrabble2/frontend/src/Games_page/Action/Draw_button.js"],"names":["React","useState","useContext","useEffect","useRef","UserContext","GamesContext","BlocksContext","PlayerListContext","games_sachet","Draw_button","values","profile","setprofile","playerlistState","setplayerlistState","gameState","setgameState","playerlistRef","gamestateRef","current","drawActive","setdrawActive","Draw","drawn_tiles","player_turn","draw","return_tiles","delete_list","i","length","canDrop","canDrag","container_index","board_index","placed","just_added","forEach","return_tile","push","prevplayerlist","newplayerlist","tiles","concat","next_func","socket","emit","removed_tiles","on","socket_out","draw_by_tiles","your_index"],"mappings":"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","sourcesContent":["import React, {useState,useContext,useEffect,useRef} from 'react';\r\nimport {UserContext} from '../../UserContext.js'\r\nimport {GamesContext,BlocksContext,PlayerListContext} from '../GamesContext.js'\r\nimport {games_sachet} from '../Gamespage.js'\r\nimport './Actionbar.css'\r\n\r\nfunction Draw_button(values){\r\n    const {profile,setprofile}=useContext(UserContext)\r\n    const {playerlistState,setplayerlistState}=useContext(PlayerListContext)\r\n    const {gameState,setgameState}=useContext(GamesContext)   \r\n    const playerlistRef=useRef(null);\r\n    const gamestateRef=useRef(null);\r\n    playerlistRef.current=playerlistState\r\n    gamestateRef.current=gameState\r\n    const [drawActive,setdrawActive]=useState(false) \r\n\r\n    function Draw(){\r\n      var drawn_tiles=playerlistRef.current[gamestateRef.current.player_turn].draw()\r\n      let return_tiles=playerlistRef.current[gamestateRef.current.player_turn].delete_list\r\n      for (let i=0;i<return_tiles.length;i++){\r\n        return_tiles[i].canDrop=false\r\n        return_tiles[i].canDrag=false\r\n        return_tiles[i].container_index=null\r\n        return_tiles[i].board_index=null\r\n        return_tiles[i].placed=false\r\n        return_tiles[i].just_added=false\r\n      }\r\n      return_tiles.forEach((return_tile)=>{\r\n        games_sachet.push(return_tile)})\r\n\r\n        \r\n      setplayerlistState((prevplayerlist=>{\r\n        let newplayerlist=[...prevplayerlist]\r\n        newplayerlist[gamestateRef.current.player_turn].tiles=newplayerlist[gamestateRef.current.player_turn].tiles.concat(drawn_tiles)\r\n        newplayerlist[gamestateRef.current.player_turn].delete_list=[]\r\n        return newplayerlist\r\n      }))\r\n      values.next_func()\r\n      gamestateRef.current.socket.emit(\"emit_draw\",{\r\n        player_turn:gamestateRef.current.player_turn,\r\n        drawn_tiles:drawn_tiles,\r\n        removed_tiles:playerlistRef.current[gamestateRef.current.player_turn].delete_list\r\n      })\r\n      }\r\n      useEffect(()=>{\r\n        gamestateRef.current.socket.current.on(\"update_player_draw\",(socket_out)=>{\r\n          games_sachet=games_sachet.concat(socket_out.removed_tiles)\r\n          setplayerlistState((prevplayerlist=>{\r\n            let newplayerlist=[...prevplayerlist]\r\n            newplayerlist[gamestateRef.player_turn].draw_by_tiles(socket_out.drawn_tiles)\r\n            newplayerlist[gamestateRef.player_turn].delete_list=[]\r\n            return newplayerlist\r\n          }))\r\n          values.next_func()\r\n      })},[])\r\n\r\n    useEffect(()=>{\r\n        if(gamestateRef.current.player_turn==gamestateRef.current.your_index && !gamestateRef.current.just_added.length){\r\n          setdrawActive(true)\r\n        }else{\r\n          setdrawActive(false)\r\n        }\r\n      },[,gamestateRef.current.player_turn,gamestateRef.current.just_added])\r\n\r\n    return(\r\n        <div>\r\n            <button type=\"button\" className=\"draw_button\" onClick={Draw} disabled={!drawActive}>Draw</button> \r\n        </div>)\r\n}\r\n\r\nexport default Draw_button"]},"metadata":{},"sourceType":"module"}