{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\TzeHaoTay\\\\Desktop\\\\CS\\\\scrabble2\\\\frontend\\\\src\\\\Games_page\\\\Action\\\\Draw_button.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useContext, useEffect, useRef } from 'react';\nimport { UserContext } from '../../UserContext.js';\nimport { GamesContext, BlocksContext, PlayerListContext, SachetContext } from '../GamesContext.js';\nimport { games_sachet } from '../Gamespage.js';\nimport './Actionbar.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction Draw_button(values) {\n  _s();\n\n  const [drawActive, setdrawActive] = useState(false);\n  const {\n    profile,\n    setprofile\n  } = useContext(UserContext);\n  const {\n    playerlistState,\n    setplayerlistState\n  } = useContext(PlayerListContext);\n  const {\n    gameState,\n    setgameState\n  } = useContext(GamesContext);\n  const {\n    sachetState,\n    setsachetState\n  } = useContext(SachetContext);\n  const playerlistRef = useRef(null);\n  const gamestateRef = useRef(null);\n  const sachetstateRef = useRef(null);\n  playerlistRef.current = playerlistState;\n  gamestateRef.current = gameState;\n  sachetstateRef.current = sachetState;\n\n  function Draw() {\n    let sachet = { ...sachetstateRef.current\n    };\n    Object.setPrototypeOf(sachet, sachetstateRef.current);\n    var drawn_tiles = playerlistRef.current[gamestateRef.current.player_turn].draw(sachet);\n    let return_tiles = playerlistRef.current[gamestateRef.current.player_turn].delete_list;\n\n    for (let i = 0; i < return_tiles.length; i++) {\n      return_tiles[i].canDrop = false;\n      return_tiles[i].canDrag = false;\n      return_tiles[i].container_index = null;\n      return_tiles[i].board_index = null;\n      return_tiles[i].placed = false;\n      return_tiles[i].just_added = false;\n    }\n\n    console.log(\"SACHET METHODS\", sachetstateRef.current);\n    console.log(\"PLAYER METHODS\", playerlistRef.current[gamestateRef.current.player_turn]);\n    sachet.add_by_tiles(return_tiles);\n    setplayerlistState(prevplayerlist => {\n      let newplayerlist = [...prevplayerlist];\n      newplayerlist[gamestateRef.current.player_turn].tiles = newplayerlist[gamestateRef.current.player_turn].tiles.concat(drawn_tiles);\n      newplayerlist[gamestateRef.current.player_turn].delete_list = [];\n      return newplayerlist;\n    });\n    values.next_func(sachet);\n\n    for (let i = 0; i < drawn_tiles.length; i++) {\n      drawn_tiles[i].canDrop = false;\n      drawn_tiles[i].canDrag = false;\n    }\n\n    gamestateRef.current.socket.emit(\"emit_draw\", {\n      player_turn: gamestateRef.current.player_turn,\n      drawn_tiles: drawn_tiles,\n      return_tiles: playerlistRef.current[gamestateRef.current.player_turn].delete_list\n    });\n  }\n\n  useEffect(() => {\n    gamestateRef.current.socket.current.on(\"update_player_draw\", socket_out => {\n      let sachet2 = { ...sachetstateRef.current\n      };\n      Object.setPrototypeOf(sachet2, sachetstateRef.current);\n      sachet2.add_by_tiles(socket_out.return_tiles);\n      sachet2.remove_by_tiles(socket_out.drawn_tiles);\n      setplayerlistState(prevplayerlist => {\n        let newplayerlist = [...prevplayerlist];\n        newplayerlist[gamestateRef.current.player_turn].draw_by_tiles(socket_out.drawn_tiles);\n        newplayerlist[gamestateRef.current.player_turn].delete_list = [];\n        return newplayerlist;\n      });\n      values.next_func(sachet2);\n    });\n  }, []);\n  useEffect(() => {\n    if (gamestateRef.current.player_turn == gamestateRef.current.your_index && !gamestateRef.current.just_added.length) {\n      setdrawActive(true);\n    } else {\n      setdrawActive(false);\n    }\n  }, [, gamestateRef.current.player_turn, gamestateRef.current.just_added]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"button\",\n      className: \"draw_button\",\n      onClick: Draw,\n      disabled: !drawActive,\n      children: \"Draw\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 79,\n    columnNumber: 9\n  }, this);\n}\n\n_s(Draw_button, \"ZxmTVhSivPeUn8HA5FUOyaWOxX8=\");\n\n_c = Draw_button;\nexport default Draw_button;\n\nvar _c;\n\n$RefreshReg$(_c, \"Draw_button\");","map":{"version":3,"sources":["C:/Users/TzeHaoTay/Desktop/CS/scrabble2/frontend/src/Games_page/Action/Draw_button.js"],"names":["React","useState","useContext","useEffect","useRef","UserContext","GamesContext","BlocksContext","PlayerListContext","SachetContext","games_sachet","Draw_button","values","drawActive","setdrawActive","profile","setprofile","playerlistState","setplayerlistState","gameState","setgameState","sachetState","setsachetState","playerlistRef","gamestateRef","sachetstateRef","current","Draw","sachet","Object","setPrototypeOf","drawn_tiles","player_turn","draw","return_tiles","delete_list","i","length","canDrop","canDrag","container_index","board_index","placed","just_added","console","log","add_by_tiles","prevplayerlist","newplayerlist","tiles","concat","next_func","socket","emit","on","socket_out","sachet2","remove_by_tiles","draw_by_tiles","your_index"],"mappings":"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","sourcesContent":["import React, {useState,useContext,useEffect,useRef} from 'react';\r\nimport {UserContext} from '../../UserContext.js'\r\nimport {GamesContext,BlocksContext,PlayerListContext,SachetContext} from '../GamesContext.js'\r\nimport {games_sachet} from '../Gamespage.js'\r\nimport './Actionbar.css'\r\n\r\nfunction Draw_button(values){\r\n    const [drawActive,setdrawActive]=useState(false) \r\n    const {profile,setprofile}=useContext(UserContext)\r\n    const {playerlistState,setplayerlistState}=useContext(PlayerListContext)\r\n    const {gameState,setgameState}=useContext(GamesContext)   \r\n    const {sachetState,setsachetState}=useContext(SachetContext)   \r\n    const playerlistRef=useRef(null);\r\n    const gamestateRef=useRef(null);\r\n    const sachetstateRef=useRef(null);\r\n    playerlistRef.current=playerlistState\r\n    gamestateRef.current=gameState\r\n    sachetstateRef.current=sachetState\r\n    \r\n\r\n    function Draw(){\r\n      let sachet={...sachetstateRef.current}\r\n      Object.setPrototypeOf( sachet,sachetstateRef.current )\r\n      var drawn_tiles=playerlistRef.current[gamestateRef.current.player_turn].draw(sachet)\r\n      let return_tiles=playerlistRef.current[gamestateRef.current.player_turn].delete_list\r\n      for (let i=0;i<return_tiles.length;i++){\r\n        return_tiles[i].canDrop=false\r\n        return_tiles[i].canDrag=false\r\n        return_tiles[i].container_index=null\r\n        return_tiles[i].board_index=null\r\n        return_tiles[i].placed=false\r\n        return_tiles[i].just_added=false\r\n      }\r\n      console.log(\"SACHET METHODS\",sachetstateRef.current);\r\n      console.log(\"PLAYER METHODS\",playerlistRef.current[gamestateRef.current.player_turn]);\r\n      sachet.add_by_tiles(return_tiles)\r\n\r\n      setplayerlistState((prevplayerlist=>{\r\n        let newplayerlist=[...prevplayerlist]\r\n        newplayerlist[gamestateRef.current.player_turn].tiles=newplayerlist[gamestateRef.current.player_turn].tiles.concat(drawn_tiles)\r\n        newplayerlist[gamestateRef.current.player_turn].delete_list=[]\r\n        return newplayerlist\r\n      }))\r\n      values.next_func(sachet)\r\n      for (let i=0;i<drawn_tiles.length;i++){\r\n        drawn_tiles[i].canDrop=false\r\n        drawn_tiles[i].canDrag=false\r\n      }\r\n      gamestateRef.current.socket.emit(\"emit_draw\",{  \r\n        player_turn:gamestateRef.current.player_turn,\r\n        drawn_tiles:drawn_tiles,\r\n        return_tiles:playerlistRef.current[gamestateRef.current.player_turn].delete_list\r\n      })\r\n      }\r\n      useEffect(()=>{\r\n        gamestateRef.current.socket.current.on(\"update_player_draw\",(socket_out)=>{\r\n          let sachet2={...sachetstateRef.current}\r\n          Object.setPrototypeOf( sachet2,sachetstateRef.current )\r\n          sachet2.add_by_tiles(socket_out.return_tiles)\r\n          sachet2.remove_by_tiles(socket_out.drawn_tiles)\r\n          setplayerlistState((prevplayerlist=>{\r\n            let newplayerlist=[...prevplayerlist]\r\n            newplayerlist[gamestateRef.current.player_turn].draw_by_tiles(socket_out.drawn_tiles)\r\n            newplayerlist[gamestateRef.current.player_turn].delete_list=[]\r\n            return newplayerlist\r\n          }))\r\n          values.next_func(sachet2)\r\n      })},[])\r\n\r\n    useEffect(()=>{\r\n        if(gamestateRef.current.player_turn==gamestateRef.current.your_index && !gamestateRef.current.just_added.length){\r\n          setdrawActive(true)\r\n        }else{\r\n          setdrawActive(false)\r\n        }\r\n      },[,gamestateRef.current.player_turn,gamestateRef.current.just_added])\r\n\r\n    return(\r\n        <div>\r\n            <button type=\"button\" className=\"draw_button\" onClick={Draw} disabled={!drawActive}>Draw</button> \r\n        </div>)\r\n}\r\n\r\nexport default Draw_button"]},"metadata":{},"sourceType":"module"}