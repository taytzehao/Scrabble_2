{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\TzeHaoTay\\\\Desktop\\\\CS\\\\scrabble2\\\\frontend\\\\src\\\\Games_page\\\\Action\\\\Draw_button.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useContext, useEffect, useRef } from 'react';\nimport { UserContext, SocketContext } from '../../UserContext.js';\nimport { GamesContext, BlocksContext, PlayerListContext, SachetContext } from '../GamesContext.js';\nimport { games_sachet } from '../Gamespage.js';\nimport './Actionbar.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction Draw_button(values) {\n  _s();\n\n  const [drawActive, setdrawActive] = useState(false);\n  const websocket = useContext(SocketContext);\n  const {\n    profile,\n    setprofile\n  } = useContext(UserContext);\n  const {\n    playerlistState,\n    setplayerlistState\n  } = useContext(PlayerListContext);\n  const {\n    gameState,\n    setgameState\n  } = useContext(GamesContext);\n  const {\n    sachetState,\n    setsachetState\n  } = useContext(SachetContext);\n  const playerlistRef = useRef(null);\n  const gamestateRef = useRef(null);\n  const sachetstateRef = useRef(null);\n  playerlistRef.current = playerlistState;\n  gamestateRef.current = gameState;\n  sachetstateRef.current = sachetState;\n\n  function Draw() {\n    let sachet = { ...sachetstateRef.current\n    };\n    Object.setPrototypeOf(sachet, sachetstateRef.current);\n    var drawn_tiles = playerlistRef.current[gamestateRef.current.player_turn].draw(sachet);\n    let return_tiles = playerlistRef.current[gamestateRef.current.player_turn].delete_list;\n\n    for (let i = 0; i < return_tiles.length; i++) {\n      return_tiles[i].canDrop = false;\n      return_tiles[i].canDrag = false;\n      return_tiles[i].container_index = null;\n      return_tiles[i].board_index = null;\n      return_tiles[i].placed = false;\n      return_tiles[i].just_added = false;\n    }\n\n    sachet.add_by_tiles(return_tiles);\n    setplayerlistState(prevplayerlist => {\n      let newplayerlist = [...prevplayerlist];\n      newplayerlist[gamestateRef.current.player_turn].tiles = newplayerlist[gamestateRef.current.player_turn].tiles.concat(drawn_tiles);\n      newplayerlist[gamestateRef.current.player_turn].delete_list = [];\n      return newplayerlist;\n    });\n    values.next_funct(sachet);\n\n    for (let i = 0; i < drawn_tiles.length; i++) {\n      drawn_tiles[i].canDrop = false;\n      drawn_tiles[i].canDrag = false;\n    }\n\n    websocket.current.emit(\"emit_draw\", {\n      player_turn: gamestateRef.current.player_turn,\n      drawn_tiles: drawn_tiles,\n      return_tiles: playerlistRef.current[gamestateRef.current.player_turn].delete_list\n    });\n  }\n\n  useEffect(() => {\n    websocket.current.on(\"update_player_draw\", socket_out => {\n      let sachet2 = { ...sachetstateRef.current\n      };\n      Object.setPrototypeOf(sachet2, sachetstateRef.current);\n      sachet2.add_by_tiles(socket_out.return_tiles);\n      sachet2.remove_by_tiles(socket_out.drawn_tiles);\n      setplayerlistState(prevplayerlist => {\n        let newplayerlist = [...prevplayerlist];\n        newplayerlist[gamestateRef.current.player_turn].draw_by_tiles(socket_out.drawn_tiles);\n        newplayerlist[gamestateRef.current.player_turn].delete_list = [];\n        return newplayerlist;\n      });\n      values.next_func(sachet2);\n    });\n  }, []);\n  useEffect(() => {\n    console.log(\"ADDED BOOLEAN\", !gamestateRef.current.just_added.length);\n\n    if (gamestateRef.current.player_turn == gamestateRef.current.your_index && !gamestateRef.current.just_added.length) {\n      console.log();\n      setdrawActive(true);\n    } else {\n      setdrawActive(false);\n    }\n  }, [, gamestateRef.current.player_turn, gamestateRef.current.just_added]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"button\",\n      className: \"draw_button\",\n      onClick: Draw,\n      disabled: !drawActive,\n      children: \"Draw\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 82,\n    columnNumber: 9\n  }, this);\n}\n\n_s(Draw_button, \"LRu4pyh7eahKoKWDNvjPDQSwRZk=\");\n\n_c = Draw_button;\nexport default Draw_button;\n\nvar _c;\n\n$RefreshReg$(_c, \"Draw_button\");","map":{"version":3,"sources":["C:/Users/TzeHaoTay/Desktop/CS/scrabble2/frontend/src/Games_page/Action/Draw_button.js"],"names":["React","useState","useContext","useEffect","useRef","UserContext","SocketContext","GamesContext","BlocksContext","PlayerListContext","SachetContext","games_sachet","Draw_button","values","drawActive","setdrawActive","websocket","profile","setprofile","playerlistState","setplayerlistState","gameState","setgameState","sachetState","setsachetState","playerlistRef","gamestateRef","sachetstateRef","current","Draw","sachet","Object","setPrototypeOf","drawn_tiles","player_turn","draw","return_tiles","delete_list","i","length","canDrop","canDrag","container_index","board_index","placed","just_added","add_by_tiles","prevplayerlist","newplayerlist","tiles","concat","next_funct","emit","on","socket_out","sachet2","remove_by_tiles","draw_by_tiles","next_func","console","log","your_index"],"mappings":"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","sourcesContent":["import React, {useState,useContext,useEffect,useRef} from 'react';\r\nimport {UserContext,SocketContext} from '../../UserContext.js'\r\nimport {GamesContext,BlocksContext,PlayerListContext,SachetContext} from '../GamesContext.js'\r\nimport {games_sachet} from '../Gamespage.js'\r\nimport './Actionbar.css'\r\n\r\nfunction Draw_button(values){\r\n    const [drawActive,setdrawActive]=useState(false) \r\n    const websocket=useContext(SocketContext)\r\n    const {profile,setprofile}=useContext(UserContext)\r\n    const {playerlistState,setplayerlistState}=useContext(PlayerListContext)\r\n    const {gameState,setgameState}=useContext(GamesContext)   \r\n    const {sachetState,setsachetState}=useContext(SachetContext)   \r\n    const playerlistRef=useRef(null);\r\n    const gamestateRef=useRef(null);\r\n    const sachetstateRef=useRef(null);\r\n    playerlistRef.current=playerlistState\r\n    gamestateRef.current=gameState\r\n    sachetstateRef.current=sachetState\r\n    \r\n\r\n    function Draw(){\r\n      let sachet={...sachetstateRef.current}\r\n      Object.setPrototypeOf( sachet,sachetstateRef.current )\r\n      var drawn_tiles=playerlistRef.current[gamestateRef.current.player_turn].draw(sachet)\r\n      let return_tiles=playerlistRef.current[gamestateRef.current.player_turn].delete_list\r\n      for (let i=0;i<return_tiles.length;i++){\r\n        return_tiles[i].canDrop=false\r\n        return_tiles[i].canDrag=false\r\n        return_tiles[i].container_index=null\r\n        return_tiles[i].board_index=null\r\n        return_tiles[i].placed=false\r\n        return_tiles[i].just_added=false\r\n      }\r\n      \r\n      sachet.add_by_tiles(return_tiles)\r\n\r\n      setplayerlistState((prevplayerlist=>{\r\n        let newplayerlist=[...prevplayerlist]\r\n        newplayerlist[gamestateRef.current.player_turn].tiles=newplayerlist[gamestateRef.current.player_turn].tiles.concat(drawn_tiles)\r\n        newplayerlist[gamestateRef.current.player_turn].delete_list=[]\r\n        return newplayerlist\r\n      }))\r\n     \r\n      values.next_funct(sachet)\r\n      for (let i=0;i<drawn_tiles.length;i++){\r\n        drawn_tiles[i].canDrop=false\r\n        drawn_tiles[i].canDrag=false\r\n      }\r\n      websocket.current.emit(\"emit_draw\",{  \r\n        player_turn:gamestateRef.current.player_turn,\r\n        drawn_tiles:drawn_tiles,\r\n        return_tiles:playerlistRef.current[gamestateRef.current.player_turn].delete_list\r\n      })\r\n      }\r\n      useEffect(()=>{\r\n        websocket.current.on(\"update_player_draw\",(socket_out)=>{\r\n          let sachet2={...sachetstateRef.current}\r\n          Object.setPrototypeOf( sachet2,sachetstateRef.current )\r\n          sachet2.add_by_tiles(socket_out.return_tiles)\r\n          sachet2.remove_by_tiles(socket_out.drawn_tiles)\r\n          setplayerlistState((prevplayerlist=>{\r\n            let newplayerlist=[...prevplayerlist]\r\n            newplayerlist[gamestateRef.current.player_turn].draw_by_tiles(socket_out.drawn_tiles)\r\n            newplayerlist[gamestateRef.current.player_turn].delete_list=[]\r\n            return newplayerlist\r\n          }))\r\n          values.next_func(sachet2)\r\n      })},[])\r\n\r\n    useEffect(()=>{\r\n      console.log(\"ADDED BOOLEAN\",!gamestateRef.current.just_added.length)\r\n        if(gamestateRef.current.player_turn==gamestateRef.current.your_index && !gamestateRef.current.just_added.length){\r\n          console.log()\r\n          setdrawActive(true)\r\n        }else{\r\n          setdrawActive(false)\r\n        }\r\n      },[,gamestateRef.current.player_turn,gamestateRef.current.just_added])\r\n\r\n    return(\r\n        <div>\r\n            <button type=\"button\" className=\"draw_button\" onClick={Draw} disabled={!drawActive}>Draw</button> \r\n        </div>)\r\n}\r\n\r\nexport default Draw_button"]},"metadata":{},"sourceType":"module"}